# Інструкція з доступу до ArgoCD
![Демонстрація: розгортання k3d та залежностей; деплоймент ArgoCD та доступ до WEB Console](../.data/poc.gif)
## Передумови

Перед початком роботи переконайтеся, що у вас встановлені:
- Docker або Podman
- k3d
- kubectl
- helm
- iproute2 (для команди ip)

## Встановлення залежностей

Ви можете використати команди з Makefile для встановлення всіх необхідних компонентів:

1. Перевірте наявність всіх компонентів:
```bash
make system-check
```

2. Встановіть всі необхідні компоненти:
```bash
make all
```

Або встановіть компоненти окремо:
```bash
make install-k3d     # Встановлення k3d
make install-kubectl # Встановлення kubectl
make install-helm    # Встановлення helm
```

## Встановлення ArgoCD

1. Клонуйте репозиторій:
```bash
git clone <repository-url>
cd <repository-name>
```

2. Запустіть встановлення:
```bash
make seed
```

Ця команда:
- Створить локальний k3d кластер з увімкненим Traefik
- Встановить ArgoCD
- Налаштує Ingress для доступу до веб-інтерфейсу через шлях /argocd

## Доступ до веб-інтерфейсу

1. Після успішного встановлення, ви отримаєте URL для доступу до ArgoCD у форматі:
```
http://argocd.<ваш-ip>.nip.io/argocd
```

2. Відкрийте цей URL у вашому браузері
   (nip.io автоматично резолвить домен у вашу IP-адресу)

3. Введіть облікові дані:
   - Логін: `admin`
   - Пароль: (буде показаний після встановлення)

### Альтернативний спосіб через port-forwarding

Якщо доступ через Ingress не працює, ви можете використати port-forwarding:

1. Запустіть команду:
```bash
make seed-proxy
```

2. Відкрийте в браузері:
```
https://localhost:8080
```

3. Використовуйте ті самі облікові дані:
   - Логін: `admin`
   - Пароль: (буде показаний після встановлення)

## Видалення

Для видалення кластера та всіх компонентів виконайте:
```bash
make seed-destroy
```

Для повного видалення всіх компонентів (включаючи k3d, kubectl та helm):
```bash
make clear
```

## Вирішення проблем

### Проблеми з доступом через Ingress

1. Перевірте свою IP-адресу:
```bash
ip route get 1 | awk '{print $7; exit}'
```

2. Перевірте статус Ingress:
```bash
kubectl get ingress -n argocd
```

3. Перевірте логи Traefik:
```bash
kubectl logs -n kube-system -l app.kubernetes.io/name=traefik
```

### Проблеми з доступом

Якщо виникають проблеми з доступом:
1. Переконайтеся, що ви використовуєте правильний URL з /argocd
2. Перевірте, що порти 80 та 443 не зайняті іншими сервісами
3. Перевірте, що ваша IP-адреса правильно визначена за допомогою команди ip
4. Якщо проблема залишається, спробуйте використати port-forwarding

## Додаткова інформація

- [Офіційна документація ArgoCD](https://argo-cd.readthedocs.io/)
- [Документація k3d](https://k3d.io/)
- [Документація Traefik](https://doc.traefik.io/traefik/) 